<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
	
		<template name="Homepage" priority="29" t-name="website.homepage">
			<t t-call="website.layout">

				<div class="container">
					<!-- Current Day Code -->
					<div class="col-xs-12 col-sm-3 col-md-2 same_height-divs" style="text-align: center">
						<span class="c_month_year-text"> 
							<span t-esc="today[4]"/><br/>
							<span t-esc="today[5]"/>
						</span>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 same_height-divs current_ev-border">
						<div class="c_month-text">
							Não há luar como o de Janeiro, nem amor como o primeiro.
						</div>
						<!-- <div>
							<img src=""/>
						</div> -->
						<hr class="today-text-hr"/>
						<div class = "c_month-text">
							<a data-toggle="modal" t-attf-href="#TodayEventsModal">
								<span t-esc="today[2]"/>
							</a>
						</div>
						<!-- <div>
							<img src=""/>
						</div> -->
					</div>
					<div class="col-xs-6 col-sm-3 col-md-2 same_height-divs">
						<div style="margin-top:5%" class="clearfix today_temps-text">
							<div style="width: 20%; float: left;">
								<span t-esc="today[9]"/>ºC <br/>
								<span t-esc="today[8]"/>ºC
							</div>
							<div style="width: 80%; float: left;">
								<!--<img style="height:35px;width:35px" class="day_weather-icon" t-attf-src="https:{{today[10]}}"/>-->
								<div t-attf-class="{{today[10]}}" />
							</div>
						</div>
						<div class="clearfix">
							<hr class="today-hr"/>
							<div class="today_week_day-text">
								<span t-esc="today[1]"/>
							</div>
							<hr class="today2-hr"/>
						</div>
						<div class="clearfix">
							<div class="today-text">
								<span t-esc="today[0]"/>
							</div>
						</div>
					</div>
					<!-- End of Current Day -->
					<!-- Calendar start generated by python -->
					<t t-set="c_month" t-value="today[3]"/>
					<t t-foreach="calendar" t-as="cal">
						<!-- Ultimas -->

						<div t-if="cal_index == 2"> 
							<div class="col-xs-6 col-sm-6 col-md-4 ultimas-bg day-border same_height-divs">
								<div class="ult-txt-tit full-width">
									<p style="padding-top: 4%">ÚLTIMAS</p>
								</div>
								<div class="owl-carousel owl-theme owl-loaded owl-drag">
									<div class="owl-stage-outer">
										<div class="owl-stage" style="transform: translate3d(-1470px, 0px, 0px); transition: all 0.25s ease 0s; width: 5880px;">
											<t t-foreach="posts" t-as="p">
												<div class="owl-item" style="width: 235px; margin-right: 10px;">
													<div class="item">
														<div class="ult-txt-res">
															<a t-attf-href="/blog/1/post/{{p.id}}">
																<h4 style="margin-bottom:0px" t-esc="p.name"/>
															</a>
															<span class="text_content ultimas_overflow-text" t-field="p.content"/>
														</div>
													</div>
												</div>
											</t>
										</div>
									</div>
								</div>
							</div>


						</div>
						<!-- END of Ultimas -->

						<script>
							var posts_div = $('.text_content');
							posts_div.text(posts_div.text().substring(0,300));
						</script>

						<t t-if="cal[3] in (1, 4, 7, 10)">
							<t t-if="cal[6]" t-set="monthcolor" t-value="'month1_we-bg'"/>
							<t t-else="" t-set="monthcolor" t-value="'month1_wd-bg'"/>
						</t>
						<t t-elif="cal[3] in (2, 5, 8, 11)">
							<t t-if="cal[6]" t-set="monthcolor" t-value="'month2_we-bg'"/>
							<t t-else="" t-set="monthcolor" t-value="'month2_wd-bg'"/>
						</t>
						<t t-else="">
							<t t-if="cal[6]" t-set="monthcolor" t-value="'month3_we-bg'"/>
							<t t-else="" t-set="monthcolor" t-value="'month3_wd-bg'"/>
						</t>

						<!-- Variables -->
						<t t-set="dayIndex" t-value="cal_index"/>
						<t t-set="callModal" t-value="'#event_modal'+str(dayIndex+1)"/>
						<t t-set="genModal" t-value="'event_modal'+str(dayIndex+1)"/>
						<t t-set="day_weather_img" t-value="'https:'+str(cal[10])"/>
						<t t-set="moon_img" t-value="{'Lua nova': 'https://upload.wikimedia.org/wikipedia/commons/e/e0/Twemoji_1f311.svg',
						 'Lua cheia': 'https://upload.wikimedia.org/wikipedia/commons/7/78/Twemoji_1f315.svg',
						  'Quarto crescente': 'https://upload.wikimedia.org/wikipedia/commons/4/40/Twemoji_1f313.svg',
						   'Quarto minguante': 'https://upload.wikimedia.org/wikipedia/commons/6/67/Twemoji_1f317.svg'}"/>
						<t t-if="cal[11] in moon_img.keys()" t-set="moon" t-value="moon_img[cal[11]]"/>
						<t t-else="" t-set="moon" t-value="''"/>
						<!-- END of Variables -->
						
						<!-- Day code -->
						<div style="height:165px" t-attf-class="col-xs-6 col-sm-3 col-md-2 {{monthcolor}} day-border same_height-divs">
							<div class="clearfix event_day-text" style="height:35px">
								<div t-if="cal[0] == 1" class="new_month-text">
									<span t-esc="cal[4]"/>
									<span t-esc="cal[5]"/>
								</div>
                				<a data-toggle="modal" t-attf-href="{{callModal}}">
									<span t-esc="cal[2]"/>
								</a>
            				</div>
            				<hr class="weekday-hr"/>		
            				<div class="clearfix" style="margin-top: -5%;">
								<div class="col-xs-6 col-sm-6 col-md-6 temp_day-text pull-left">
									<div class="row">
										<t t-if="cal[9]!='' and cal[10]!= ''">
											<div style="align:right; text-align:right;">
												<img t-attf-src="{{moon}}" style="width: 20px; height=20px;"/>
											</div>
											<hr class="temps-hr"/>
											<div style="width:50%; float: left;">
												<t t-if="cal[9]!=''">
													<span t-esc="cal[9]"/>ºC<br/>
													<span t-esc="cal[8]"/>ºC
												</t>
											</div>
											<div style="width:50%; float: left;">
												<!--<img class="day_weather-icon" t-attf-src="{{day_weather_img}}"/>-->
												<div t-attf-class="{{day_weather_img}} partly-cloudy-day" />
											</div>
										</t>
										<t t-else="">
											<div t-if="moon!=''" style="align:left; text-align:left;">
												<img t-attf-src="{{moon}}" style="width: 20px; height=20px;"/>
												<hr class="temps-hr"/>
											</div>
										</t>
									</div>
								</div>
								<div class="col-xs-6 col-sm-6 col-md-6 pull-right">
									<div class="row">
										<div class="week_day-text">
											<span t-esc="cal[1]"/>
										</div>
										<div class="day-text">
											<span class="day-text" t-esc="cal[0]"/>
										</div>
									</div>
								</div>
							</div>
        				</div>
						<!-- END of Day -->
						
						<!-- Day events modal -->
						<t t-if="cal[2] != ''">
							<t t-set="eventsIDs" t-value="cal[7]"/>
							<t t-set="eventsIDs" t-value="str(eventsIDs).split('-')"/>
							<div class="modal fade" t-attf-id="{{genModal}}" role="dialog">
								<div class="modal-dialog">
									<div class="modal-content">
										<div class="modal-header" style="border-bottom:0px;">
											<button type="button" class="close_btn-css" data-dismiss="modal" aria-label=""><span>×</span></button>
										</div>
										<div class="modal-body">			
											<div class="event_modal-css">
												<div class="event_modal_day-text">
													Dia <span t-esc="cal[0]"/>, <span t-esc="cal[1]"/> de <span t-esc="cal[5]"/>
												</div>
												<p style="color: green; font-size: 16px; font-weight: bold; text-align:left; margin-bottom:5px">Eventos:</p>
												<ul class="media-list">
													<li t-foreach="events" t-as="event" class="media" t-if="str(event.id) in eventsIDs">
														<div itemscope="itemscope" itemtype="http://schema.org/Event" class="media-body">
															<h4 class="media-heading">
																<a itemprop="url" t-att-class="event.state == 'done' and 'text-success'" t-attf-href="/event/#{ slug(event) }/#{(not event.menu_id) and 'register' or ''}">
																	<span itemprop="name" t-field="event.name"> </span>
																</a>
															</h4>
															<div>
																<t t-if="event.organizer_id">
																	Organizado por: <span t-field="event.organizer_id"> </span>
																</t>
															</div>
															<div>
																<i class="fa fa-clock-o"/>
																De: <span itemprop="startDate" t-field="event.with_context(tz=event.date_tz).date_begin" t-options="{&quot;hide_seconds&quot;:&quot;True&quot;}"/>
																<i>até</i>
																<span itemprop="endDate" t-field="event.with_context(tz=event.date_tz).date_end" t-options="{&quot;hide_seconds&quot;:&quot;True&quot;}"/>
															</div>
															<div itemprop="location" t-field="event.address_id" t-options="{&quot;widget&quot;: &quot;contact&quot;,&quot;fields&quot;: [&quot;city&quot;]}"/>
															<div class="text-muted" t-if="event.event_type_id">
																<i class="fa fa-tag"/> <span t-field="event.event_type_id"/>
															</div>
															<div>
																<t t-raw="event.description" />
															</div>
														</div>
													</li>
												</ul>
												<p class="Debug-text">Array: <span t-esc="cal"/></p>
											</div>
										</div>
									</div>
								</div>
							</div>
						</t>
						<!-- END of Day events modal -->
					</t>
					<!-- End of Calendar generated by python -->

					<!-- Today Events Modal -->
					<t t-set="Today_ev_IDs" t-value="today[7]"/>
					<t t-set="Today_ev_IDs" t-value="str(Today_ev_IDs).split('-')"/>
					<div class="modal fade" t-attf-id="TodayEventsModal" role="dialog">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header" style="border-bottom:0px;">
									<button type="button" class="close_btn-css" data-dismiss="modal" aria-label=""><span>×</span></button>
								</div>
								<div class="modal-body">			
									<div class="event_modal-css">
										<div class="event_modal_day-text">
											Dia <span t-esc="today[0]"/>, <span t-esc="today[1]"/> de <span t-esc="today[5]"/>
										</div>
										<p style="color: green; font-size: 16px; font-weight: bold; text-align:left; margin-bottom:5px">Eventos:</p>
										<ul class="media-list">
											<li t-foreach="events" t-as="event" class="media" t-if="str(event.id) in Today_ev_IDs">
												<div itemscope="itemscope" itemtype="http://schema.org/Event" class="media-body">
													<h4 class="media-heading">
														<a itemprop="url" t-att-class="event.state == 'done' and 'text-success'" t-attf-href="/event/#{ slug(event) }/#{(not event.menu_id) and 'register' or ''}">
															<span itemprop="name" t-field="event.name"> </span>
														</a>
													</h4>
													<div>
														<t t-if="event.organizer_id">
															Organizado por: <span t-field="event.organizer_id"> </span>
														</t>
													</div>
													<div>
														<i class="fa fa-clock-o"/>
														De: <span itemprop="startDate" t-field="event.with_context(tz=event.date_tz).date_begin" t-options="{&quot;hide_seconds&quot;:&quot;True&quot;}"/>
														<i>até</i>
														<span itemprop="endDate" t-field="event.with_context(tz=event.date_tz).date_end" t-options="{&quot;hide_seconds&quot;:&quot;True&quot;}"/>
													</div>
													<div itemprop="location" t-field="event.address_id" t-options="{&quot;widget&quot;: &quot;contact&quot;,&quot;fields&quot;: [&quot;city&quot;]}"/>
													<div class="text-muted" t-if="event.event_type_id">
														<i class="fa fa-tag"/> <span t-field="event.event_type_id"/>
													</div>
													<div>
														<t t-raw="event.description"/>
													</div>
												</div>
											</li>
										</ul>
										<p class="Debug-text">Array: <span t-esc="today"/></p>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- END of today Events Modal -->

       			</div>
				<script type="application/javascript">
					$(document).ready(function(){
  						$(".owl-carousel").owlCarousel();
					});
					var owl = $('.owl-carousel');
					owl.owlCarousel({
						items: 1,
						loop: true,
						margin: 10,
						autoplay: true,
						autoplayTimeout: 10000,
						autoplayHoverPause: true,
						dots: false
					});
				</script>
			</t>

		</template>

	</data>
</odoo>
